<?php /* /includes/hero_preline.php */ ?>
<section class="relative overflow-hidden bg-white">
  <!-- Background Image -->
  <div class="absolute inset-0 top-0 z-0 pointer-events-none">
    <img src="/public/images/hero-section/siding-repair-home-hoosier-cladding.png" 
         alt="Professional siding repair and installation services" 
         class="w-full h-full object-cover opacity-25"
         loading="eager">
    <div class="absolute inset-0 bg-gradient-to-r from-white/70 via-white/60 to-white/50"></div>
  </div>
  <div class="relative z-10 max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8 pt-safe pt-16 sm:pt-20 lg:pt-24 pb-safe">
    <div class="flex flex-col gap-4 sm:gap-6">
      <!-- Copy Section -->
      <div class="flex flex-col justify-center text-center lg:text-left">

        <!-- Main Headline -->
        <h1 class="text-4xl sm:text-5xl lg:text-6xl xl:text-7xl font-bold tracking-tight text-gray-900 leading-tight mb-3 sm:mb-4 lg:mb-6 text-center lg:text-left">
          <span class="text-blue-600">South Bend's</span><br>
          Premier Siding Experts
        </h1>

        <!-- Rotating Sub-headlines -->
        <div class="mb-3 sm:mb-4 lg:mb-6 text-center lg:text-left">
          <div id="hc-rotator"
               class="relative h-12 sm:h-16 lg:h-20 overflow-hidden"
               aria-live="polite"
               aria-atomic="true">
            <span class="sr-only">Local service highlights:</span>

            <!-- Slides: all in DOM, not display:none (use translate/opacity for a11y & SEO) -->
            <div class="hc-rot-slide opacity-100 translate-y-0 text-base sm:text-lg lg:text-xl text-gray-600 leading-relaxed">Indiana's Premier Siding & Exterior Experts — Serving South Bend and Beyond</div>
            <div class="hc-rot-slide opacity-0 translate-y-3 text-base sm:text-lg lg:text-xl text-gray-600 leading-relaxed">South Bend's Trusted Siding Contractors — Indiana's Exterior Specialists</div>
            <div class="hc-rot-slide opacity-0 translate-y-3 text-base sm:text-lg lg:text-xl text-gray-600 leading-relaxed">Energy-Efficient Siding Installation & Repair Across Northern Indiana</div>
            <div class="hc-rot-slide opacity-0 translate-y-3 text-base sm:text-lg lg:text-xl text-gray-600 leading-relaxed">Quality Craftsmanship for Indiana Homes — Free Local Estimates</div>
            <div class="hc-rot-slide opacity-0 translate-y-3 text-base sm:text-lg lg:text-xl text-gray-600 leading-relaxed">Fiber Cement & Vinyl Siding Pros in South Bend, IN</div>
          </div>

        </div>

        <!-- Trust Signals -->
        <div class="flex flex-wrap gap-4 justify-center lg:justify-start mb-4 sm:mb-4 lg:mb-6">
          <div class="hidden sm:flex items-center text-sm text-gray-600 bg-white/80 px-3 py-2 rounded-lg">
            <svg class="w-4 h-4 text-green-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
            </svg>
            Free estimates
          </div>
          <div class="hidden sm:flex items-center text-sm text-gray-600 bg-white/80 px-3 py-2 rounded-lg">
            <svg class="w-4 h-4 text-green-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
            </svg>
            Same-day response
          </div>
          <div class="flex items-center text-sm text-gray-600 bg-white/80 px-3 py-2 rounded-lg">
            <svg class="w-4 h-4 text-green-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
            </svg>
            Licensed in Indiana
          </div>
        </div>

      </div>

    </div>
  </div>
</section>

<!-- AI Chat Assistant Hero Section -->
<section class="relative py-16 sm:py-20 lg:py-24 pt-safe pb-safe bg-gradient-to-b from-blue-50/30 via-white to-white">
  
  <div class="relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="text-center mb-12">
      <h2 class="text-3xl sm:text-4xl lg:text-5xl font-bold text-gray-900 mb-4">
        <span class="text-blue-600">Homeowner AI</span> – by Hoosier Cladding
      </h2>
      <p class="text-lg sm:text-xl text-gray-600 max-w-2xl mx-auto">
        Get instant expert answers about siding, repairs, and home maintenance for South Bend and Northern Indiana.
      </p>
    </div>
  </div>

  <!-- Full-width on mobile, max-width on desktop -->
  <div class="w-full md:max-w-4xl lg:max-w-5xl xl:max-w-6xl 2xl:max-w-7xl mx-auto md:px-6 lg:px-8">
      <!-- Preline AI Chat Template Structure -->
      <div class="bg-white/80 backdrop-blur-sm">
        <!-- Chat Header -->
        <div class="flex items-center gap-x-1 sm:gap-x-3 p-2 sm:p-4 border-b border-gray-200">
          <div class="flex items-center gap-x-1 sm:gap-x-3 min-w-0 flex-1">
            <div class="flex-shrink-0">
              <div class="w-7 h-7 sm:w-10 sm:h-10 bg-blue-600 rounded-full flex items-center justify-center">
                <svg class="w-3 h-3 sm:w-5 sm:h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"/>
                </svg>
              </div>
            </div>
            <div class="grow min-w-0">
              <span class="block text-xs sm:text-sm font-semibold text-gray-800 truncate">Hoosier Cladding AI</span>
              <span class="block text-xs text-gray-500 truncate">Local Home Expert for South Bend & Northern Indiana</span>
            </div>
          </div>
          <div class="flex items-center flex-shrink-0">
            <span class="inline-flex items-center gap-x-1 py-1 px-1.5 sm:px-2 rounded-full text-xs font-medium bg-green-100 text-green-800">
              <span class="w-1.5 h-1.5 bg-green-500 rounded-full"></span>
              <span class="text-[10px] sm:text-xs">Online</span>
            </span>
          </div>
        </div>

        <!-- Chat Messages -->
        <div class="p-3 sm:p-4">
          <div id="hc-thread" class="space-y-3 sm:space-y-4 mb-3 sm:mb-4 min-h-[400px] max-h-[500px] sm:min-h-[450px] sm:max-h-[550px] md:min-h-[500px] md:max-h-[600px] lg:min-h-[500px] lg:max-h-[600px] xl:min-h-[550px] xl:max-h-[650px] overflow-y-auto border border-gray-200 p-3 sm:p-4" aria-live="polite">
            <div class="flex gap-x-2 sm:gap-x-3">
              <div class="flex-shrink-0">
                <div class="w-6 h-6 sm:w-8 sm:h-8 bg-blue-100 rounded-full flex items-center justify-center">
                  <svg class="w-3 h-3 sm:w-4 sm:h-4 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"/>
                  </svg>
                </div>
              </div>
              <div class="grow min-w-0">
                <div class="bg-gray-100 p-3 sm:p-4 rounded-lg">
                  <p class="text-xs sm:text-sm text-gray-800 leading-relaxed">
                    I'm the AI assistant built by Hoosier Cladding, trained specifically on Indiana siding installation, home repairs, and maintenance best practices. I understand Midwest weather challenges, energy-efficiency needs, and regional building standards that affect your home's exterior. Whether you're dealing with drafty walls, fading siding, or storm damage, I'll guide you with accurate, local insights. What home-exterior challenge can I help you solve today?
                  </p>
                </div>
              </div>
            </div>
          </div>

          <!-- Input Form -->
          <form id="hc-form" class="flex gap-x-2">
            <div class="flex-1">
              <input id="hc-input" type="text" class="py-2 sm:py-3 px-3 sm:px-4 block w-full border-2 border-blue-400 rounded-lg text-xs sm:text-sm focus:border-blue-600 focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:pointer-events-none shadow-sm" placeholder="Ask about siding replacement, storm damage, or energy efficiency...">
            </div>
            <button type="submit" class="py-2 sm:py-3 px-3 sm:px-4 inline-flex items-center justify-center rounded-lg text-xs sm:text-sm font-semibold border border-transparent bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 disabled:pointer-events-none min-w-[36px] min-h-[36px] sm:min-w-[44px] sm:min-h-[44px]">
              <svg class="flex-shrink-0 w-3 h-3 sm:w-4 sm:h-4" fill="currentColor" viewBox="0 0 24 24">
                <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
              </svg>
            </button>
          </form>

          <!-- Suggestion Chips -->
          <div class="flex flex-wrap gap-1 sm:gap-2 mt-3 sm:mt-4">
            <button type="button" data-suggest="What siding materials work best for South Bend Indiana weather conditions?" class="py-1.5 sm:py-2 px-2 sm:px-3 inline-flex items-center gap-x-1 sm:gap-x-2 text-xs font-medium border border-transparent bg-blue-100 text-blue-800 hover:bg-blue-200 rounded-md">
              <span class="hidden sm:inline">Siding Replacement</span>
              <span class="sm:hidden">Siding</span>
            </button>
            <button type="button" data-suggest="How do I assess and repair storm damage to my home's exterior?" class="py-1.5 sm:py-2 px-2 sm:px-3 inline-flex items-center gap-x-1 sm:gap-x-2 text-xs font-medium border border-transparent bg-blue-100 text-blue-800 hover:bg-blue-200 rounded-md">
              <span class="hidden sm:inline">Storm Damage Repair</span>
              <span class="sm:hidden">Storm</span>
            </button>
            <button type="button" data-suggest="What energy-efficient siding options work best for Indiana homes?" class="py-1.5 sm:py-2 px-2 sm:px-3 inline-flex items-center gap-x-1 sm:gap-x-2 text-xs font-medium border border-transparent bg-blue-100 text-blue-800 hover:bg-blue-200 rounded-md">
              <span class="hidden sm:inline">Energy Efficiency</span>
              <span class="sm:hidden">Energy</span>
            </button>
          </div>

          <!-- Footer Attribution -->
          <div class="mt-4 pt-4 border-t border-gray-200">
            <p class="text-xs text-gray-500 text-center">
              Powered by <span class="font-semibold text-gray-700">ChatGPT</span> & <span class="font-semibold text-blue-700">OurCasa.ai</span>
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Chat widget script (kept minimal; uses /api/chat.php backend) -->
<script>
(function(){
  const elForm   = document.getElementById('hc-form');
  const elInput  = document.getElementById('hc-input');
  const elThread = document.getElementById('hc-thread');
  const endpoint = '/api/chat.php';

  function addBubble(text, who) {
    const wrap = document.createElement('div');
    wrap.className = 'flex items-start gap-3';
    
    if (who === 'you') {
      wrap.innerHTML = `
        <div class="bg-blue-600 rounded-2xl rounded-tr-sm p-3 max-w-[85%] ml-auto">
          <p class="text-sm text-white">${esc(text)}</p>
        </div>
        <div class="w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0 mt-1">
          <svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
          </svg>
        </div>
      `;
    } else {
      wrap.innerHTML = `
        <div class="w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 mt-1">
          <svg class="w-3 h-3 text-blue-600" fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
          </svg>
        </div>
        <div class="bg-gray-50 rounded-2xl rounded-tl-sm p-3 max-w-[85%]">
          <p class="text-sm text-gray-700">${fmt(text)}</p>
        </div>
      `;
    }
    
    elThread.appendChild(wrap);
    elThread.scrollTop = elThread.scrollHeight;
  }
  function esc(s){return s.replace(/[&<>"']/g,m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[m]));}
  function fmt(s){
    return esc(s)
      .replace(/\*\*(.+?)\*\*/g,'<strong>$1</strong>')
      .replace(/(https?:\/\/\S+)/g,'<a class="underline" href="$1" target="_blank" rel="nofollow noopener">$1</a>')
      .replace(/\n/g,'<br/>');
  }

  async function ask(msg){
    addBubble(msg,'you');
    addBubble('Analyzing your home\'s exterior data...','bot');
    try {
      const res = await fetch(endpoint, { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({message: msg}) });
      const data = await res.json();
      const last = elThread.lastElementChild; if (last) last.remove();
      addBubble((data && data.reply) ? data.reply : 'Analysis incomplete. Please rephrase your query for optimal results.','bot');
    } catch(e){
      const last = elThread.lastElementChild; if (last) last.remove();
      addBubble('System temporarily unavailable. Please retry your analysis request.','bot');
    }
  }

  elForm.addEventListener('submit', e => {
    e.preventDefault();
    const msg = elInput.value.trim();
    if (!msg) return;
    elInput.value = '';
    ask(msg);
  });

  document.querySelectorAll('[data-suggest]').forEach(btn=>{
    btn.addEventListener('click', ()=> {
      elInput.value = btn.getAttribute('data-suggest');
      elInput.focus();
    });
  });
})();

// Rotating headlines functionality
(function(){
  const root = document.getElementById('hc-rotator');
  if(!root) return;
  const slides = Array.from(root.querySelectorAll('.hc-rot-slide'));
  const btnPrev = root.querySelector('.hc-rot-prev');
  const btnNext = root.querySelector('.hc-rot-next');
  const idxEl   = root.querySelector('.hc-rot-index');
  let i = 0, t;

  function show(n){
    slides.forEach((el, k)=>{
      const active = k === n;
      el.classList.toggle('opacity-100', active);
      el.classList.toggle('translate-y-0', active);
      el.classList.toggle('opacity-0', !active);
      el.classList.toggle('translate-y-3', !active);
      el.setAttribute('aria-hidden', active ? 'false' : 'true');
      el.tabIndex = active ? 0 : -1;
    });
    if (idxEl) idxEl.textContent = `(${n+1}/${slides.length})`;
    i = n;
  }

  function next(){ show((i+1) % slides.length); }
  function prev(){ show((i-1+slides.length) % slides.length); }

  btnNext && btnNext.addEventListener('click', ()=>{ next(); reset(); });
  btnPrev && btnPrev.addEventListener('click', ()=>{ prev(); reset(); });

  let intervalMs = 4000;
  function reset(){ clearInterval(t); t = setInterval(next, intervalMs); }
  show(0); t = setInterval(next, intervalMs);

  // Pause on hover for UX
  root.addEventListener('mouseenter', ()=> clearInterval(t));
  root.addEventListener('mouseleave', reset);
})();
</script>

<style>
/* Lightweight transition classes for rotating headlines */
#hc-rotator .hc-rot-slide {
  position: absolute;
  left: 0; right: 0;
  transition: opacity .45s ease, transform .45s ease;
  will-change: transform, opacity;
}
#hc-rotator .opacity-0 { opacity: 0; }
#hc-rotator .opacity-100 { opacity: 1; }
#hc-rotator .translate-y-0 { transform: translateY(0); }
#hc-rotator .translate-y-3 { transform: translateY(0.5rem); }
</style>

